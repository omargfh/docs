import{d as k,u as C,I as S,c as v,w as p,k as u,O as D,o as b,f,D as N,i as h,h as d,t as L,j as R}from"#entry";import V from"./CXIvgB0I.js";import j from"./DC7IkJHe.js";import"./Blt3xjRC.js";import"./CgiAIXOa.js";import"./BG7SiWYA.js";import"./BAKoBVkn.js";import"./kdDlK9dw.js";import"./HbAwO7QK.js";import"./KXMxA-Qm.js";import"./CxSvMUf_.js";import"./BezGBr39.js";import"./B2Q0M_Lh.js";import"./CRSb-D5W.js";import"./DaKitZw5.js";function y(i){return i.replace(/\.html$/,"")}class A{key;lifetimeMs;constructor(t,o=null){this.key=t,this.lifetimeMs=o}get(){const t=JSON.parse(localStorage.getItem(this.key)||"null");return t&&this.checkValidity(t)?t.data:null}set(t){const o={data:t,timestamp:Date.now()};localStorage.setItem(this.key,JSON.stringify(o))}delete(){localStorage.removeItem(this.key)}checkValidity(t){return this.lifetimeMs===null?!0:!(Date.now()-t.timestamp>this.lifetimeMs)}}function F(i,t=null,o){return async()=>{const s=new A(i,t),l=s.get();if(l!==null)return l;const c=await o();return setTimeout(()=>s.set(c),0),c}}const U={class:"w-full [&>.min-h-screen]:min-h-0 lg:pr-5 pb-10 min-h-rest"},M={class:"p-4 md:p-0"},O=k({__name:"PrimitiveCatalog",props:{surround:{},dictionaryDisplayName:{},dictionaryHomeDirectory:{},indexFileURI:{},currentItemId:{},currentItemLabel:{},primRoot:{}},async setup(i){let t,o;const s=C(),l=r=>r.id===i.currentItemId,c=r=>{const n=r.toLowerCase();return(m.value||[]).filter(a=>a.title.toLowerCase().includes(n))},g=async r=>(await $fetch(r)).split(`
`).map(e=>e.trim()).map(e=>e.split(" ")).map(e=>e.filter(a=>a.length>0)).filter(e=>e.length>=2).map(e=>({title:e.slice(0,-1).join(" "),id:y(e.at(-1))})).map(({id:e,title:a})=>({id:e,title:a,url:"/"+[i.primRoot,encodeURIComponent(e)].join("/")})),{data:m,pending:I,error:x}=([t,o]=S(()=>D(i.indexFileURI,F([s.productVersion,"primitive-catalog",i.indexFileURI].join("-"),null,()=>g(i.indexFileURI)),{server:!1})),t=await t,o(),t),w=!Array.isArray(m.value)&&!x?!0:I;return(r,n)=>{const e=R,a=V,_=j;return b(),v(_,{label:i.dictionaryDisplayName,items:u(m)||[],"item-prefix":"primitive:",query:c,"is-selected":l,"selected-item-label":i.currentItemLabel,"scroll-margin-top":150,"is-loading":u(w),"with-route-transition":""},{default:p(()=>[f("div",U,[N(r.$slots,"default"),f("p",M,[n[0]||(n[0]=d(" Take me to the full ",-1)),h(e,{href:u(y)(i.dictionaryHomeDirectory)},{default:p(()=>[d(L(i.dictionaryDisplayName),1)]),_:1},8,["href"]),n[1]||(n[1]=d(". ",-1))]),h(a,{surround:i.surround,class:"mt-auto"},null,8,["surround"])])]),_:3},8,["label","items","selected-item-label","is-loading"])}}}),Z=Object.assign(O,{__name:"PrimitiveCatalog"});export{Z as default};
